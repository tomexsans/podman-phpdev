# Use the same base image as your php-fpm service
FROM bitnami/php-fpm:latest

# Install supervisor inside that same PHP environment
USER root
RUN install_packages supervisor

# Add NodeSource repo and install Node.js (LTS version)
RUN curl -fsSL https://deb.nodesource.com/setup_lts.x | bash - \
    && install_packages nodejs

# Optional: verify installation
RUN node -v && npm -v

# Optional: create Supervisor log folder
RUN mkdir -p /var/log/supervisor

# Start Supervisor instead of php-fpm
CMD ["/usr/bin/supervisord", "-n"]
